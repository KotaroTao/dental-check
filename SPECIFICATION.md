# 歯科簡易診断WEBサービス 仕様書

## 1. プロジェクト概要

### 1.1 サービス名
**DentalCheck（デンタルチェック）**

### 1.2 サービス概要
選択式の簡単な質問に答えることで、お口の健康状態や矯正の必要性などを簡易診断できるWEBサービス。診断結果画面には歯科医院が自由にカスタマイズ可能な予約フォームやCTAを設置でき、来院促進につなげる。

### 1.3 ターゲットユーザー

#### エンドユーザー（診断を受ける人）
- お口の健康が気になる一般の方
- 子供の歯並び・矯正タイミングが気になる保護者
- 歯医者に行くべきか迷っている方

#### 管理者ユーザー（歯科医院）
- 集患・マーケティングに活用したい歯科医院
- 患者とのタッチポイントを増やしたい歯科医院

### 1.4 主な目的
1. エンドユーザーが手軽にお口の状態をセルフチェックできる
2. 歯科医院への受診を自然に促す導線を作る
3. 歯科医院がLPやSNSで活用できる集患ツールを提供する

---

## 2. 機能要件

### 2.1 診断機能

#### 2.1.1 診断の種類（初期リリース）

| 診断名 | 対象 | 質問数 | 所要時間 |
|--------|------|--------|----------|
| お口年齢診断 | 成人全般 | 10問 | 約2分 |
| 子供の矯正タイミングチェック | 保護者（子供：3〜12歳） | 10問 | 約2分 |
| 歯周病リスクチェック | 成人（30歳以上推奨） | 10問 | 約2分 |
| ホワイトニング適性診断 | 成人全般 | 8問 | 約1.5分 |

#### 2.1.2 診断フロー
```
[トップページ] → [診断選択] → [質問画面(1〜10問)] → [結果画面] → [予約/CTA]
```

#### 2.1.3 質問形式
- **単一選択式**：1つの選択肢を選ぶ
- **複数選択式**：該当するものをすべて選ぶ
- **スケール式**：1〜5段階で評価する

#### 2.1.4 結果算出ロジック
- 各回答に点数を設定（重み付け可能）
- 合計点数に基づいて結果カテゴリを判定
- カテゴリごとにメッセージとアドバイスを表示

### 2.2 結果画面機能

#### 2.2.1 結果表示要素
- **診断結果タイトル**（例：「あなたのお口年齢は○○歳です」）
- **結果サマリー**（グラフ・アイコン等で視覚化）
- **詳細アドバイス**（改善ポイント等）
- **注意事項**（医療診断ではない旨の免責）

#### 2.2.2 CTA（Call to Action）エリア
歯科医院がカスタマイズ可能なエリア：
- 予約フォーム埋め込み
- 電話番号リンク
- LINE公式アカウントへの誘導
- 外部予約システムへのリンク
- カスタムHTMLの設置

#### 2.2.3 シェア機能
- Twitter/Xシェア
- LINEシェア
- URLコピー
- 結果画像ダウンロード（OGP画像）

### 2.3 管理機能（歯科医院向け）

#### 2.3.1 アカウント管理
- 医院アカウント登録・ログイン
- 医院情報編集（名前、住所、電話番号等）
- パスワード変更・リセット

#### 2.3.2 診断カスタマイズ
- 使用する診断の選択（有効/無効）
- 結果画面のCTAエリア編集
- カラーテーマの選択
- ロゴ・画像のアップロード

#### 2.3.3 分析・レポート
- 診断実施数（日別/月別）
- 診断完了率
- 結果分布
- CTA クリック率

#### 2.3.4 埋め込みコード発行
- iframe埋め込みコード
- 直接リンクURL
- QRコード生成

### 2.4 システム管理機能（運営者向け）

#### 2.4.1 医院管理
- 医院アカウントの一覧・検索
- 医院アカウントの有効/無効切り替え

#### 2.4.2 診断コンテンツ管理
- 診断テンプレートの追加・編集・削除
- 質問・選択肢・スコアの編集
- 結果パターンの編集

#### 2.4.3 全体統計
- 総診断実施数
- 医院別利用状況
- 人気診断ランキング

---

## 3. 診断コンテンツ詳細設計

### 3.1 お口年齢診断

#### 質問一覧

| No | 質問 | 選択肢 | スコア |
|----|------|--------|--------|
| 1 | 1日の歯磨き回数は？ | 0回/1回/2回/3回以上 | 0/5/10/10 |
| 2 | 歯間ブラシやフロスを使っていますか？ | 使っていない/たまに/毎日 | 0/5/10 |
| 3 | 定期的に歯科検診を受けていますか？ | 受けていない/年1回程度/半年に1回以上 | 0/5/10 |
| 4 | 歯茎から出血することがありますか？ | よくある/たまにある/ほとんどない | 0/5/10 |
| 5 | 口臭が気になることはありますか？ | よくある/たまにある/ほとんどない | 0/5/10 |
| 6 | 冷たいものや熱いものがしみますか？ | よくある/たまにある/ほとんどない | 0/5/10 |
| 7 | 歯がグラグラする感じはありますか？ | ある/少しある/ない | 0/5/10 |
| 8 | 喫煙習慣はありますか？ | 吸う/以前吸っていた/吸わない | 0/5/10 |
| 9 | 甘い飲み物やお菓子をよく摂りますか？ | よく摂る/たまに/あまり摂らない | 0/5/10 |
| 10 | 最後に歯科医院に行ったのはいつですか？ | 1年以上前/半年〜1年前/半年以内 | 0/5/10 |

#### 結果パターン

| スコア範囲 | お口年齢 | カテゴリ | メッセージ |
|------------|----------|----------|------------|
| 0-30 | 実年齢+15歳 | 要注意 | お口の健康に赤信号です。すぐに歯科医院での検診をおすすめします。 |
| 31-50 | 実年齢+10歳 | 注意 | お口のケアに改善の余地があります。定期検診を受けてみましょう。 |
| 51-70 | 実年齢+5歳 | やや注意 | まずまずのケアができていますが、もう少し意識を高めましょう。 |
| 71-85 | 実年齢相当 | 良好 | 良いケアができています。この調子で続けましょう。 |
| 86-100 | 実年齢-5歳 | 優秀 | 素晴らしいお口のケアです！このまま維持してください。 |

---

### 3.2 子供の矯正タイミングチェック

#### 質問一覧

| No | 質問 | 選択肢 | スコア |
|----|------|--------|--------|
| 1 | お子さんの年齢は？ | 3〜5歳/6〜8歳/9〜12歳 | 情報収集 |
| 2 | 指しゃぶりや爪を噛む癖がありますか（ありましたか）？ | 現在もある/以前あった/ない | 10/5/0 |
| 3 | 口呼吸をしていることが多いですか？ | はい/時々/いいえ | 10/5/0 |
| 4 | 乳歯の生え変わりは順調ですか？ | 遅い気がする/普通/早い気がする | 5/0/5 |
| 5 | 歯並びで気になる点はありますか？ | 出っ歯/受け口/ガタガタ/すきっ歯/特にない | 10/10/10/5/0 |
| 6 | 食べ物を噛むとき、片側だけで噛んでいませんか？ | はい/時々/いいえ | 10/5/0 |
| 7 | 発音で気になる点はありますか？ | ある/少しある/ない | 10/5/0 |
| 8 | 顔の左右で非対称な部分がありますか？ | 気になる/少し気になる/気にならない | 10/5/0 |
| 9 | ご家族に歯並びの悪い方はいますか？ | いる/わからない/いない | 10/5/0 |
| 10 | 以前、歯科医院で歯並びについて指摘を受けたことはありますか？ | ある/覚えていない/ない | 10/5/0 |

#### 結果パターン

| スコア範囲 | カテゴリ | タイトル | メッセージ |
|------------|----------|----------|------------|
| 0-20 | 様子見 | 今すぐの矯正は不要かもしれません | 現時点では大きな問題は見られません。ただし、成長とともに変化することがありますので、定期的なチェックをおすすめします。 |
| 21-45 | 相談推奨 | 一度専門家に相談してみましょう | いくつか気になるポイントがあります。矯正専門医への相談をおすすめします。早期発見が治療の選択肢を広げます。 |
| 46-70 | 早期相談 | 早めの相談をおすすめします | 矯正治療の検討をおすすめする兆候が見られます。お子さんの成長段階に合わせた最適な治療タイミングを相談しましょう。 |
| 71-100 | 至急相談 | できるだけ早く専門医へ | 複数の気になる兆候があります。早期に矯正専門医の診察を受けることを強くおすすめします。 |

---

### 3.3 歯周病リスクチェック

#### 質問一覧

| No | 質問 | 選択肢 | スコア |
|----|------|--------|--------|
| 1 | 歯磨き時に歯茎から血が出ますか？ | よく出る/たまに出る/出ない | 15/8/0 |
| 2 | 歯茎が赤く腫れていますか？ | はい/少し/いいえ | 15/8/0 |
| 3 | 口臭が気になりますか？ | 常に/時々/いいえ | 10/5/0 |
| 4 | 歯が以前より長くなった気がしますか？ | はい/少し/いいえ | 15/8/0 |
| 5 | 歯と歯の間にものが詰まりやすくなりましたか？ | はい/時々/いいえ | 10/5/0 |
| 6 | 歯がグラグラする感じはありますか？ | はい/少し/いいえ | 15/8/0 |
| 7 | 喫煙習慣はありますか？ | 吸う/以前吸っていた/吸わない | 10/5/0 |
| 8 | 糖尿病と診断されていますか？ | はい/予備軍/いいえ | 10/5/0 |
| 9 | ストレスを感じることが多いですか？ | 多い/普通/少ない | 5/3/0 |
| 10 | 最後に歯石取りをしたのはいつですか？ | 1年以上前/半年〜1年前/半年以内 | 10/5/0 |

#### 結果パターン

| スコア範囲 | リスクレベル | タイトル | メッセージ |
|------------|--------------|----------|------------|
| 0-25 | 低 | 歯周病リスクは低めです | 現在の習慣を続けてください。ただし、定期的な検診で予防を心がけましょう。 |
| 26-50 | 中 | やや注意が必要です | いくつかの気になるポイントがあります。歯科での検診とクリーニングをおすすめします。 |
| 51-75 | 高 | 歯周病のリスクが高いです | 歯周病の兆候がいくつか見られます。早めに歯科医院を受診してください。 |
| 76-100 | 非常に高 | すぐに歯科受診を | 歯周病が進行している可能性があります。できるだけ早く専門的な治療を受けてください。 |

---

### 3.4 ホワイトニング適性診断

#### 質問一覧

| No | 質問 | 選択肢 | スコア |
|----|------|--------|--------|
| 1 | 歯の色が気になりますか？ | とても気になる/少し気になる/気にならない | 適性判定 |
| 2 | コーヒー、紅茶、ワインをよく飲みますか？ | 毎日/週数回/ほとんど飲まない | 情報収集 |
| 3 | 喫煙習慣はありますか？ | 吸う/以前吸っていた/吸わない | 情報収集 |
| 4 | 知覚過敏（冷たいものがしみる）はありますか？ | ある/少しある/ない | -10/-5/10 |
| 5 | 虫歯の治療中、または治療が必要な歯はありますか？ | ある/わからない/ない | -15/-5/10 |
| 6 | 前歯に被せ物や詰め物はありますか？ | 多数ある/少しある/ない | 情報収集 |
| 7 | 妊娠中または授乳中ですか？ | はい/いいえ | -20/10 |
| 8 | ホワイトニングの経験はありますか？ | ある/ない | 情報収集 |

#### 結果パターン

| スコア範囲 | 適性 | タイトル | メッセージ |
|------------|------|----------|------------|
| 負数 | 要相談 | まずは歯科医師にご相談ください | ホワイトニングの前に確認すべき点があります。歯科医院でカウンセリングを受けてから検討しましょう。 |
| 0-20 | 条件付き可 | 条件付きで可能です | ホワイトニングは可能ですが、いくつか確認事項があります。専門家に相談することをおすすめします。 |
| 21-40 | 適性あり | ホワイトニングに適しています | ホワイトニングを始めるのに良いコンディションです。種類や方法について相談してみましょう。 |

---

## 4. 画面設計・UI/UX仕様

### 4.1 画面一覧

| 画面名 | URL例 | 説明 |
|--------|-------|------|
| トップページ | / | サービス紹介、診断一覧 |
| 診断選択画面 | /diagnosis | 利用可能な診断の一覧 |
| 診断実施画面 | /diagnosis/:type | 質問に回答する画面 |
| 結果画面 | /result/:id | 診断結果とCTA表示 |
| 医院ログイン | /clinic/login | 医院向けログイン |
| 医院ダッシュボード | /clinic/dashboard | 統計・管理トップ |
| CTA設定画面 | /clinic/settings/cta | 結果画面のCTAカスタマイズ |
| 埋め込みコード画面 | /clinic/embed | 埋め込みコード発行 |
| 管理者ログイン | /admin/login | 運営者向けログイン |
| 管理者ダッシュボード | /admin/dashboard | 全体統計・管理 |

### 4.2 診断実施画面 UI仕様

```
┌─────────────────────────────────────────────┐
│  [ロゴ]          お口年齢診断               │
├─────────────────────────────────────────────┤
│                                             │
│   ━━━━━━━━━━●━━━━━━━━━━  (5/10)            │
│                                             │
│   Q5. 口臭が気になることはありますか？      │
│                                             │
│   ┌─────────────────────────────────┐       │
│   │  ○  よくある                    │       │
│   └─────────────────────────────────┘       │
│   ┌─────────────────────────────────┐       │
│   │  ○  たまにある                  │       │
│   └─────────────────────────────────┘       │
│   ┌─────────────────────────────────┐       │
│   │  ○  ほとんどない                │       │
│   └─────────────────────────────────┘       │
│                                             │
│   [← 戻る]              [次へ →]            │
│                                             │
└─────────────────────────────────────────────┘
```

#### UI要件
- **プログレスバー**: 進捗を視覚的に表示
- **質問番号**: 現在の質問/全質問数を表示
- **選択肢**: タップしやすい大きなボタン形式
- **ナビゲーション**: 戻る・次へボタン（次へは選択後に有効化）
- **アニメーション**: 画面遷移時にスムーズなアニメーション

### 4.3 結果画面 UI仕様

```
┌─────────────────────────────────────────────┐
│  [ロゴ]          診断結果                   │
├─────────────────────────────────────────────┤
│                                             │
│         🦷 あなたのお口年齢は               │
│                                             │
│              【 42歳 】                     │
│           （実年齢より+7歳）                │
│                                             │
│   ┌─────────────────────────────────────┐   │
│   │  [グラフ: 結果の視覚化]              │   │
│   └─────────────────────────────────────┘   │
│                                             │
│   📝 アドバイス                             │
│   歯磨きの回数や歯間ケアに改善の            │
│   余地があります。定期検診も...             │
│                                             │
├─────────────────────────────────────────────┤
│  【医院カスタマイズエリア】                 │
│  ┌─────────────────────────────────────┐   │
│  │  🏥 ○○歯科クリニック                 │   │
│  │                                       │   │
│  │  お気軽にご相談ください               │   │
│  │                                       │   │
│  │  [📞 電話予約] [📱 LINE予約]          │   │
│  │                                       │   │
│  │  [🗓️ WEB予約はこちら]                 │   │
│  └─────────────────────────────────────┘   │
├─────────────────────────────────────────────┤
│                                             │
│   結果をシェア: [X] [LINE] [📋コピー]       │
│                                             │
│   ※この診断は医療診断ではありません        │
│                                             │
└─────────────────────────────────────────────┘
```

### 4.4 レスポンシブ対応

| デバイス | 画面幅 | 対応方針 |
|----------|--------|----------|
| スマートフォン | 〜767px | メイン対応（縦スクロール基本） |
| タブレット | 768px〜1023px | 2カラムレイアウト可 |
| PC | 1024px〜 | 中央寄せ、最大幅制限 |

### 4.5 アクセシビリティ対応

- キーボードナビゲーション対応
- スクリーンリーダー対応（aria-label等）
- 十分な色コントラスト比
- フォーカス状態の明確な表示
- 文字サイズ変更対応

---

## 5. 技術仕様

### 5.1 技術スタック

#### フロントエンド
| 項目 | 技術 |
|------|------|
| フレームワーク | Next.js 14 (App Router) |
| 言語 | TypeScript |
| スタイリング | Tailwind CSS |
| UIコンポーネント | shadcn/ui |
| 状態管理 | Zustand |
| フォーム | React Hook Form + Zod |
| アニメーション | Framer Motion |

#### バックエンド
| 項目 | 技術 |
|------|------|
| ランタイム | Node.js |
| フレームワーク | Next.js API Routes |
| ORM | Prisma |
| 認証 | NextAuth.js |
| バリデーション | Zod |

#### インフラ・データベース
| 項目 | 技術 |
|------|------|
| ホスティング | Vercel |
| データベース | PostgreSQL (Supabase or Neon) |
| ファイルストレージ | Cloudflare R2 or Vercel Blob |
| CDN | Vercel Edge Network |

### 5.2 API設計

#### エンドユーザー向けAPI

| メソッド | エンドポイント | 説明 |
|----------|----------------|------|
| GET | /api/diagnosis | 診断一覧取得 |
| GET | /api/diagnosis/:type | 診断詳細・質問取得 |
| POST | /api/diagnosis/:type/submit | 診断結果送信 |
| GET | /api/result/:id | 結果取得 |

#### 医院管理者向けAPI

| メソッド | エンドポイント | 説明 |
|----------|----------------|------|
| POST | /api/clinic/auth/login | ログイン |
| POST | /api/clinic/auth/logout | ログアウト |
| GET | /api/clinic/profile | 医院情報取得 |
| PUT | /api/clinic/profile | 医院情報更新 |
| GET | /api/clinic/settings | 設定取得 |
| PUT | /api/clinic/settings | 設定更新 |
| GET | /api/clinic/stats | 統計取得 |
| GET | /api/clinic/embed-code | 埋め込みコード取得 |

#### システム管理者向けAPI

| メソッド | エンドポイント | 説明 |
|----------|----------------|------|
| GET | /api/admin/clinics | 医院一覧 |
| GET | /api/admin/stats | 全体統計 |
| GET | /api/admin/diagnosis | 診断テンプレート一覧 |
| POST | /api/admin/diagnosis | 診断テンプレート作成 |
| PUT | /api/admin/diagnosis/:id | 診断テンプレート更新 |

### 5.3 セキュリティ要件

- HTTPS必須
- CSRF対策
- XSS対策（エスケープ処理）
- SQLインジェクション対策（Prismaによるパラメータ化）
- レート制限（API呼び出し制限）
- 入力値バリデーション（Zod）
- 認証トークンの安全な管理（HttpOnly Cookie）

---

## 6. データ構造

### 6.1 ER図

```
┌───────────────┐       ┌───────────────┐
│    Clinic     │       │  DiagnosisType │
├───────────────┤       ├───────────────┤
│ id            │       │ id            │
│ name          │       │ name          │
│ email         │       │ slug          │
│ password_hash │       │ description   │
│ phone         │       │ question_count│
│ address       │       │ is_active     │
│ logo_url      │       │ created_at    │
│ settings      │       │ updated_at    │
│ created_at    │       └───────────────┘
│ updated_at    │              │
└───────────────┘              │
       │                       │
       │         ┌─────────────┘
       │         │
       ▼         ▼
┌───────────────────────────┐
│    ClinicDiagnosisConfig  │
├───────────────────────────┤
│ id                        │
│ clinic_id (FK)            │
│ diagnosis_type_id (FK)    │
│ is_enabled                │
│ cta_config (JSON)         │
│ theme_config (JSON)       │
│ created_at                │
│ updated_at                │
└───────────────────────────┘

┌───────────────┐       ┌───────────────┐
│   Question    │       │    Choice     │
├───────────────┤       ├───────────────┤
│ id            │◄──────│ id            │
│ diagnosis_id  │       │ question_id   │
│ order         │       │ text          │
│ text          │       │ score         │
│ type          │       │ order         │
│ created_at    │       │ created_at    │
└───────────────┘       └───────────────┘

┌───────────────┐       ┌───────────────┐
│ ResultPattern │       │ DiagnosisResult│
├───────────────┤       ├───────────────┤
│ id            │       │ id            │
│ diagnosis_id  │       │ diagnosis_id  │
│ min_score     │       │ clinic_id     │
│ max_score     │       │ result_id     │
│ title         │       │ total_score   │
│ message       │       │ answers (JSON)│
│ advice        │       │ created_at    │
│ created_at    │       └───────────────┘
└───────────────┘
```

### 6.2 主要テーブル定義

#### Clinic（医院）
```sql
CREATE TABLE clinics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  phone VARCHAR(20),
  address TEXT,
  logo_url VARCHAR(500),
  settings JSONB DEFAULT '{}',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### DiagnosisType（診断タイプ）
```sql
CREATE TABLE diagnosis_types (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  slug VARCHAR(100) UNIQUE NOT NULL,
  description TEXT,
  question_count INTEGER NOT NULL,
  estimated_minutes INTEGER DEFAULT 2,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### Question（質問）
```sql
CREATE TABLE questions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  diagnosis_type_id UUID REFERENCES diagnosis_types(id),
  order_index INTEGER NOT NULL,
  text TEXT NOT NULL,
  question_type VARCHAR(20) DEFAULT 'single', -- single, multiple, scale
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### Choice（選択肢）
```sql
CREATE TABLE choices (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  question_id UUID REFERENCES questions(id),
  order_index INTEGER NOT NULL,
  text VARCHAR(255) NOT NULL,
  score INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ResultPattern（結果パターン）
```sql
CREATE TABLE result_patterns (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  diagnosis_type_id UUID REFERENCES diagnosis_types(id),
  min_score INTEGER NOT NULL,
  max_score INTEGER NOT NULL,
  category VARCHAR(100) NOT NULL,
  title VARCHAR(255) NOT NULL,
  message TEXT NOT NULL,
  advice TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### DiagnosisResult（診断結果）
```sql
CREATE TABLE diagnosis_results (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  diagnosis_type_id UUID REFERENCES diagnosis_types(id),
  clinic_id UUID REFERENCES clinics(id),
  result_pattern_id UUID REFERENCES result_patterns(id),
  total_score INTEGER NOT NULL,
  answers JSONB NOT NULL, -- 回答詳細
  user_age INTEGER, -- 任意入力
  session_id VARCHAR(100), -- 匿名トラッキング用
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### ClinicDiagnosisConfig（医院別診断設定）
```sql
CREATE TABLE clinic_diagnosis_configs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  clinic_id UUID REFERENCES clinics(id),
  diagnosis_type_id UUID REFERENCES diagnosis_types(id),
  is_enabled BOOLEAN DEFAULT true,
  cta_config JSONB DEFAULT '{}', -- CTAボタン設定
  theme_config JSONB DEFAULT '{}', -- カラーテーマ等
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(clinic_id, diagnosis_type_id)
);
```

### 6.3 CTA設定JSON構造

```json
{
  "cta_config": {
    "heading": "ご予約・ご相談はこちら",
    "subheading": "お気軽にお問い合わせください",
    "buttons": [
      {
        "type": "phone",
        "label": "電話予約",
        "value": "03-1234-5678",
        "icon": "phone"
      },
      {
        "type": "line",
        "label": "LINE予約",
        "value": "https://line.me/R/ti/p/@xxxxx",
        "icon": "line"
      },
      {
        "type": "link",
        "label": "WEB予約",
        "value": "https://example.com/reserve",
        "icon": "calendar"
      }
    ],
    "custom_html": "<div>カスタムHTML</div>",
    "show_clinic_info": true
  },
  "theme_config": {
    "primary_color": "#2563eb",
    "secondary_color": "#f59e0b",
    "background_color": "#ffffff"
  }
}
```

---

## 7. 非機能要件

### 7.1 パフォーマンス

| 項目 | 目標値 |
|------|--------|
| ページ読み込み時間（LCP） | 2.5秒以内 |
| 操作応答時間（FID） | 100ms以内 |
| レイアウトシフト（CLS） | 0.1以下 |
| API応答時間 | 200ms以内（95パーセンタイル） |

### 7.2 可用性

| 項目 | 目標値 |
|------|--------|
| 稼働率 | 99.5%以上 |
| 計画メンテナンス | 月1回、深夜帯 |
| 障害復旧時間 | 4時間以内 |

### 7.3 スケーラビリティ

| 項目 | 初期想定 | 将来想定 |
|------|----------|----------|
| 同時接続数 | 100 | 1,000 |
| 日間診断数 | 1,000 | 10,000 |
| 登録医院数 | 50 | 500 |

### 7.4 対応ブラウザ

| ブラウザ | バージョン |
|----------|------------|
| Chrome | 最新2バージョン |
| Safari | 最新2バージョン |
| Firefox | 最新2バージョン |
| Edge | 最新2バージョン |
| iOS Safari | iOS 14以上 |
| Android Chrome | Android 10以上 |

---

## 8. 開発フェーズ

### Phase 1: MVP（最小実用版）
- [ ] プロジェクトセットアップ
- [ ] データベース設計・構築
- [ ] お口年齢診断の実装
- [ ] 結果画面（基本版）
- [ ] シェア機能

### Phase 2: 医院管理機能
- [ ] 医院アカウント機能
- [ ] CTAカスタマイズ機能
- [ ] 埋め込みコード発行
- [ ] 基本統計機能

### Phase 3: 診断拡充
- [ ] 子供の矯正タイミングチェック
- [ ] 歯周病リスクチェック
- [ ] ホワイトニング適性診断

### Phase 4: 機能強化
- [ ] 詳細分析・レポート
- [ ] 管理者機能
- [ ] テーマカスタマイズ拡張
- [ ] LINE連携

---

## 9. 免責事項・法的考慮

### 9.1 免責表示（必須）

診断結果画面に以下の文言を必ず表示：

> ※この診断は医療行為ではありません。実際の診断・治療については、必ず歯科医師にご相談ください。

### 9.2 プライバシーポリシー

- 収集する情報（診断回答、アクセスログ等）
- 利用目的（サービス提供、統計分析）
- 第三者提供の有無
- Cookie使用について

### 9.3 利用規約

- サービス内容
- 禁止事項
- 免責事項
- 知的財産権

---

## 10. 今後の拡張案

### 10.1 機能拡張案
- AI による個別アドバイス生成
- 診断履歴の保存・比較機能
- 予約システムとの連携（API連携）
- 多言語対応（英語、中国語等）
- 音声入力対応

### 10.2 診断コンテンツ拡張案
- インプラント適性診断
- 入れ歯のお悩みチェック
- 顎関節症リスクチェック
- 口腔ケア習慣診断
- 子供の虫歯リスクチェック

---

## 付録

### A. 用語集

| 用語 | 説明 |
|------|------|
| CTA | Call to Action。ユーザーに行動を促すボタンやリンク |
| OGP | Open Graph Protocol。SNSシェア時に表示される情報 |
| 診断テンプレート | 質問と結果パターンのセット |

### B. 参考資料

- Next.js ドキュメント: https://nextjs.org/docs
- Prisma ドキュメント: https://www.prisma.io/docs
- Tailwind CSS: https://tailwindcss.com/docs
- shadcn/ui: https://ui.shadcn.com/

---

**ドキュメントバージョン**: 1.0
**最終更新日**: 2024年1月
**作成者**: DentalCheck開発チーム
